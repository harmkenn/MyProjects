---
title: "Coordinate Conversions Package"
author: "Ken Harmon"
date: "2019 December 03"
output:
  html_document:
    code_folding: hide
    fig_align: center
    fig_height: 6
    fig_width: 12
    keep_md: yes
editor_options:
  chunk_output_type: console
---

# {.tabset .tabset-fade}







## Without CRS

Wikipedia formulas and coefficent


```r
lng <- 45.72
lat <- -3.96
lngr <- lng*pi/180 # Longitude in radians
latr <- lat*pi/180 # Latitude in radians

# Lets go find Easting

sin1 <- pi/(180*3600) #One Second
a <- 6378137 # Equitorial Radius
b <- 6356752.31424518 #Polar Radius
k0 <- .9996 #Scalar Factor Constant
zone <- floor(1/6*lng)+31 #Longitude Zone
Czone <- 6*zone - 183 #Longitude of the center of the zone
dlng <- lng - Czone # Longitude from the center of the zone
p <- dlng*3600/10000 #Hecta seconds?
e <- sqrt(1-(b/a)^2) #eccentricity
e1 <- sqrt(a^2-b^2)/b
e1sq <- e1^2
c <- a^2/b
nu <- a/sqrt(1-(e*sin(latr))^2) #r curv 2
Kiv <- nu*cos(latr)*sin1*k0*10000 #Coef for UTM 4
Kv <- (sin1*cos(latr))^3*(nu/6)*
  (1-tan(latr)^2+e1sq*cos(latr)^2)*k0*10^12 #Coef for UTM 5
Easting <- 500000+Kiv*p+Kv*p^3

# Now let's go find Northing
n <- (a-b)/(a+b)
A0 <- a*(1-n+(5*n^2/4)*(1-n)+(81*n^4/64)*(1-n)) # Meridional Arc Length
B0 <- (3*a*n/2)*(1-n-(7*n^2/8)*(1-n)+55*n^4/64) # Meridional Arc Length
C0 <- (15*a*n^2/16)*(1-n+(3*n^2/4)*(1-n)) # Meridional Arc Length
D0 <- (35*a*n^3/48)*(1-n+11*n^2/16) # Meridional Arc Length
E0 <- (315*a*n^4/51)*(1-n) # Meridional Arc Length
S <- A0*latr - B0*sin(2*latr) + C0*sin(4*latr) - D0*sin(6*latr) + E0*sin(8*latr) # Meridional Arc
Ki <- S*k0 #Coef for UTM 1
Kii <- nu*sin(latr)*cos(latr)*sin1^2*k0*100000000/2 #Coef for UTM 2
Kiii <- ((sin1^4*nu*sin(latr)*cos(latr)^3)/24)*(5-tan(latr)^2+9*e1sq*cos(latr)^2*cos(latr)^4)*k0*10^16 #Coef for UTM 2
Northing <- Ki + Kii * p^2 + Kiii * p^4 
if (lat < 0) {Northing <- 10000000 + Northing} # In the Southern Hemisphere is Northing is measured from the south pole instead of from the equator

Easting <- round(Easting,0)
Northing <- round(Northing,0)


## Now let's turn UTM into MGRS

#Latitude gridzone letters
lgzl <- c("C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X")

# 100km grid Square easting letter
esqls <- as.matrix(rbind(c("A","B","C","D","E","F","G","H"),
                         c("J","K","L","M","N","P","Q","R"),
                         c("S","T","U","V","W","X","Y","Z")))
colnames(esqls) <- 1:8
rownames(esqls) <- c(1,2,0)

nsqls <- c("B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V")

lzc <- (lat+80-(lat+80)%%8)/8+1 # LAtitude letter zone count
lz <- lgzl[lzc]
esq <- plyr::round_any(Easting,100000,floor)/100000 #Grab the first digit off of easting
emod <- mod(zone,3) # Zone mod 3 for 100km lookup
if (emod == 0) {emod <- 3} #turn mod zero into row 3
esql <- esqls[emod,esq] #Here is the 100km easting grid letter
nsq <-  plyr::round_any(Northing,100000,floor)/100000 #Grab off the first two digits off the Northing
  if((zone %% 2) == 0) {nsq <- nsq +5} #Even grid zones increase the letter by 5
  if(nsq>99){nsq <- nsq - 20} #If it goes over the top then cycle back to "A"
nsql <- nsqls[nsq]
east <- plyr::round_any(Easting,1) - plyr::round_any(Easting,100000,floor) #Snatch the right 5 digits off the easting
easting5 <- f_pad_zero(round(east,0), width = 5, pad.char = "0") #fill the front with zeros if needed
north <- plyr::round_any(Northing,1) - plyr::round_any(Northing,100000,floor) #Snatch the right 5 digits off the northing
northing5 <- f_pad_zero(north, width = 5, pad.char = "0") #fill the front with zeros if needed

utmz <- f_pad_zero(zone, width = 2, pad.char = "0") #pad the zone with a zero, if needed
MGRS <- paste(utmz,lz,esql,nsql,easting5,northing5,sep = "") #Paste all six pieces together
hem <- "N"
if (lat < 0) {hem <- "S"}

final <- as.data.frame(rbind(c(lng,lat, Easting,Northing,utmz,hem,MGRS))) 
colnames(final) <- c("Long","Lat","Easting","Northing","zone","Hemisphere","MGRS")              

final
```

```
##    Long   Lat Easting Northing zone Hemisphere            MGRS
## 1 45.72 -3.96  579930  9562259   38          S 38MNA7993062259
```

## Function LL2UTM2MGRS

Now that process built into a function called LL2UTM2MGRS


```r
#Function
LL2UTM2mgrs<-function(lng,lat){
  lngr <- lng*pi/180 # Longitude in radians
  latr <- lat*pi/180 # Latitude in radians
  
  # Lets go find Easting
  
  sin1 <- pi/(180*3600) #One Second
  a <- 6378137 # Equitorial Radius
  b <- 6356752.3142 #Polar Radius
  k0 <- .9996 #Scalar Factor Constant
  zone <- floor(1/6*lng)+31 #Longitude Zone
  Czone <- 6*zone - 183 #Longitude of the center of the zone
  dlng <- lng - Czone # Longitude from the center of the zone
  p <- dlng*3600/10000 #Hecta seconds?
  e <- sqrt(1-(b/a)^2) #eccentricity
  e1sq <- e^2/(1-e^2)
  nu <- a/sqrt(1-(e*sin(latr))^2) #r curv 2
  Kiv <- nu*cos(latr)*sin1*k0*10000 #Coef for UTM 4
  Kv <- (sin1*cos(latr))^3*(nu/6)*
    (1-tan(latr)^2+e1sq*cos(latr)^2)*k0*10^12 #Coef for UTM 5
  Easting <- 500000+Kiv*p+Kv*p^3
  
  # Now let's go find Northing
  n <- (a-b)/(a+b)
  A0 <- a*(1-n+(5*n^2/4)*(1-n)+(81*n^4/64)*(1-n)) # Meridional Arc Length
  B0 <- (3*a*n/2)*(1-n-(7*n^2/8)*(1-n)+55*n^4/64) # Meridional Arc Length
  C0 <- (15*a*n^2/16)*(1-n+(3*n^2/4)*(1-n)) # Meridional Arc Length
  D0 <- (35*a*n^3/48)*(1-n+11*n^2/16) # Meridional Arc Length
  E0 <- (315*a*n^4/51)*(1-n) # Meridional Arc Length
  S <- A0*latr - B0*sin(2*latr) + C0*sin(4*latr) - D0*sin(6*latr) + E0*sin(8*latr) # Meridional Arc
  Ki <- S*k0 #Coef for UTM 1
  Kii <- nu*sin(latr)*cos(latr)*sin1^2*k0*100000000/2 #Coef for UTM 2
  Kiii <- ((sin1^4*nu*sin(latr)*cos(latr)^3)/24)*(5-tan(latr)^2+9*e1sq*cos(latr)^2*cos(latr)^4)*k0*10^16 #Coef for UTM 2
  Northing <- Ki + Kii * p^2 + Kiii * p^4 
  if (lat < 0) {Northing <- 10000000 + Northing} # In the Southern Hemisphere is Northing is measured from the south pole instead of from the equator
  
  Easting <- round(Easting,0)
  Northing <- round(Northing,0)

  ## Now let's turn UTM into MGRS
  
  #Latitude gridzone letters
  lgzl <- c("C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","X")
  
  # 100km grid Square easting letter
  esqls <- as.matrix(rbind(c("A","B","C","D","E","F","G","H"),
                           c("J","K","L","M","N","P","Q","R"),
                           c("S","T","U","V","W","X","Y","Z")))
  colnames(esqls) <- 1:8
  rownames(esqls) <- c(1,2,0)
  
  nsqls <- c("B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V")
  
  lzc <- (lat+80-(lat+80)%%8)/8+1 # LAtitude letter zone count
  lz <- lgzl[lzc]
  esq <- plyr::round_any(Easting,100000,floor)/100000 #Grab the first digit off of easting
  emod <- mod(zone,3) # Zone mod 3 for 100km lookup
  if (emod == 0) {emod <- 3} #turn mod zero into row 3
  esql <- esqls[emod,esq] #Here is the 100km easting grid letter
  nsq <-  plyr::round_any(Northing,100000,floor)/100000 #Grab off the first two digits off the Northing
  if((zone %% 2) == 0) {nsq <- nsq +5} #Even grid zones increase the letter by 5
  if(nsq>99){nsq <- nsq - 20} #If it goes over the top then cycle back to "A"
  nsql <- nsqls[nsq]
  east <- plyr::round_any(Easting,1) - plyr::round_any(Easting,100000,floor) #Snatch the right 5 digits off the easting
  easting5 <- f_pad_zero(round(east,0), width = 5, pad.char = "0") #fill the front with zeros if needed
  north <- plyr::round_any(Northing,1) - plyr::round_any(Northing,100000,floor) #Snatch the right 5 digits off the northing
  northing5 <- f_pad_zero(north, width = 5, pad.char = "0") #fill the front with zeros if needed
  utmz <- f_pad_zero(zone, width = 2, pad.char = "0") #pad the zone with a zero, if needed
  MGRS <- paste(utmz,lz,esql,nsql,easting5,northing5,sep = "") #Paste all six pieces together
  
  
  hem <- "N"
  if (lat < 0) {hem <- "S"}

  final <- as.data.frame(rbind(c(lng,lat, Easting,Northing,utmz,hem,MGRS))) 
  colnames(final) <- c("Long","Lat","Easting","Northing","zone","Hemisphere","MGRS")  
  
   return(final)
}

## Here is the function that turns

LL2UTM2mgrs(-138.23,-34.55)
```

```
##      Long    Lat Easting Northing zone Hemisphere            MGRS
## 1 -138.23 -34.55  754179  6173372   07          S 07HGB5417973372
```

```r
longv <- (sample.int(36000,size=200,replace=TRUE)-1)/100-180
latv <- (sample.int(16000,size=200,replace=TRUE)-1)/100-80
samplell <- data.frame(cbind(longv,latv))


samplell$UTME <- NA
samplell$UTMN <- NA
samplell$gz <- NA
samplell$hem <- NA
samplell$mgrs <- NA

for (i in 1:nrow(samplell)){
  samplell$UTME[i] <- as.matrix(LL2UTM2mgrs(samplell$longv[i],samplell$latv[i]))[3]
  samplell$UTMN[i] <- as.matrix(LL2UTM2mgrs(samplell$longv[i],samplell$latv[i]))[4]
  samplell$gz[i] <- as.matrix(LL2UTM2mgrs(samplell$longv[i],samplell$latv[i]))[5]
  samplell$hem[i] <- as.matrix(LL2UTM2mgrs(samplell$longv[i],samplell$latv[i]))[6]
  samplell$mgrs[i] <- as.matrix(LL2UTM2mgrs(samplell$longv[i],samplell$latv[i]))[7]
}

datatable(samplell)
```

<!--html_preserve--><div id="htmlwidget-e5ca6f4c0cefd1f4873f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e5ca6f4c0cefd1f4873f">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200"],[-29.09,68.28,-135.72,-27.51,-160.48,48.18,45.9,-14.49,-91.35,127.8,-10.05,-15.54,-11.9,77.88,128.95,-172.33,162.04,65.91,7.66999999999999,-3.15000000000001,-85.49,106.22,141.13,78.39,94.39,41.99,95.82,31.91,79.27,-142.91,-39.65,-156,123,49.11,-68.3,41.15,-113.04,155.06,84.56,165.58,139.67,4.06999999999999,-105.38,-68.78,-22.06,31.44,91,-6.13999999999999,-137.54,5.72999999999999,-178.92,87.9,134.06,25.95,-117.38,-138.79,133.57,30.81,134.88,-152.38,20.38,77.62,157.65,-19.83,80.3,20.26,58.67,-80.17,-45.07,-29.82,-137.58,30.52,-157.88,125.94,141.11,123.77,-88.67,-108.6,151.35,-110.76,37.07,-171.15,30.13,-22.82,68.2,-126.84,167.94,-66.89,-67.15,165.81,11.95,-68.89,-126.89,-48.62,103.17,-0.219999999999999,-7.59,139.89,-139.87,-33.17,-43.48,-160.16,-141.27,49.78,-129.54,81.62,-126.28,119.12,163.35,-109.06,-153.8,128.95,-179.23,-42.95,-165.8,30.99,34.46,110.92,-96.97,137.05,-4.13999999999999,56.69,131.76,-123.89,-16.21,172.63,165.28,-3.81,64.5,141.34,-73.66,-148.32,127.38,-84.01,8.52000000000001,-32.72,172.27,-87.07,120.8,-15.73,-149.43,-133.25,85.34,166.28,134.17,-27.68,-166.58,82.99,-96.18,-171.08,7.5,-25.9,58.34,91.08,7.58000000000001,94.33,-150.73,86.52,-162.31,-136.88,-167.24,44.23,-65.5,-50.7,88.35,-155.33,38.71,-89.15,93.35,-153.34,-121.13,-39.83,137.74,-65,-159.68,89.48,177.75,-66.25,-61.67,-38.67,-77.48,-139.48,-179.34,129.34,44.07,77.44,-45.08,-58.05,-164.8,-12.15,-164.92,114.37,52.13,-162.65,81.54,94.05,57.67,-1.21000000000001,164.44,-130.51],[55.49,-40.2,20.6,55.42,-56.37,-27.67,1.37,-8.55,46.91,-55.77,77.31,29.01,12.29,42.06,13.84,-20.17,2.08,51.81,8.01000000000001,24.57,65.29,-23.56,-25.36,1.20999999999999,16.11,68.97,-49.47,-72.3,16.38,-40.52,-51.27,-41.98,-19.15,43.53,21.17,41.1,6.06,-52.48,-13.8,52.81,58.9,-18.2,-78.81,19.98,67.08,52.13,-16.58,65.55,79.46,-21.82,-4.22,44.91,-66.55,34.81,48.36,37.31,11.95,-63.26,61.2,40.1,74.46,-61.48,-9.39,17.46,-30.73,31.34,17.29,-67.13,-63.11,8.92,52.59,-73.96,13.72,-54,-51.79,47.08,21.27,2.83,78,-67.42,-53.21,11.57,73.06,13.47,-54.83,7.20999999999999,-32.16,63.01,-53.28,28.12,-32.08,-23.04,-16.98,20.57,-14.78,-14.08,-3.25,-39.06,59.1,66.9,-73.8,39.27,-0.219999999999999,10.96,34.83,-38.55,-56.04,54.03,-77.88,29.5,-23.62,-45.26,58.55,58.94,-64.48,60.02,26.73,-16.75,-56.43,11.56,65.83,67.49,23.8,-59.02,-45.11,-24.46,-75.07,-30.46,31.14,14.06,45.65,-31.13,-40.09,-21.83,47.86,-41.49,-70.19,-75.89,-46.22,40.29,-9.2,-75.02,43.69,9.29000000000001,-18,30.8,66.12,-47.4,-1.34,29.91,-0.0900000000000034,41.8,-48.2,-62.22,0.900000000000006,31.63,6.55,23.11,-13.52,-27.71,1.31999999999999,-26.7,28.55,-59.03,39.22,-54.15,-59.81,48.03,-10.54,-52.71,-6.75,5.45,-68.68,-59.77,58.93,-72.86,55.6,0.909999999999997,-3.73,73.19,29.88,-68.19,-49.82,-76.63,39.2,-24.64,29.7,-27.8,12.18,-46.67,-61.29,16.29,7.90000000000001,78.72,76.99,22.31,53.59,62.32,0.879999999999995,-47.79],["367950","438720","424972","467718","408583","221826","600123","556124","625652","424717","474252","447409","184527","738301","494597","361015","170695","700598","353426","484811","570428","624512","513080","209536","648649","619705","704301","463013","315235","338202","454655","251457","5e+05","347278","572669","680551","274212","639895","236205","539094","423370","613150","491768","523016","453935","393219","286609","632053","448147","782225","286888","571045","458259","403963","471852","695849","344288","390075","493551","552846","481459","639535","351765","624238","432985","429606","677505","535996","496468","189855","325235","423533","621102","692690","507587","558452","326735","766815","461709","510284","371113","483646","406694","302985","448610","738521","777269","606826","623343","579554","778455","511270","724661","748106","303032","800215","656663","403963","564731","492557","547330","399935","469956","366695","450622","554026","669441","638855","461332","688058","418392","496077","370229","617970","461544","387966","645208","491473","625187","723561","447917","486756","781229","448898","404816","665209","508052","422239","642997","536708","604411","374151","361896","809099","464097","523373","548033","498095","330327","437952","232981","550486","366219","640587","412132","434947","428632","650156","813838","492277","333069","591385","599570","400172","341993","626133","751021","450848","791184","314642","250746","423401","255411","517221","616538","347832","483732","339717","538294","477030","706687","408053","611144","387682","460854","581557","547257","806086","647698","510652","260485","563017","331682","508776","419696","746981","492261","396568","521757","717998","504287","218938","624563","551302","513570","608149","544348","592762","437692","386906"],["6151305","5549796","2278045","6141649","3751756","6936172","151445","9054861","5196484","3818866","8581597","3209214","1360322","4660452","1530032","7769150","230212","5743912","885640","2717344","7241618","7393956","7195183","133881","1781603","7653933","4516472","1977269","1811756","5512773","4319949","5348090","7882575","4821408","2341123","4552086","670262","4183578","8473052","5851293","6529679","7987357","1251205","2209283","7440691","5776645","8165843","7272754","8822445","7584596","9533292","4973347","2618469","3852476","5356384","4131553","1321427","2983565","6785071","4439041","8263455","3180942","8961745","1930824","6600111","3467520","1912406","2553887","3002153","987192","5829789","1790834","1517041","4012477","4262312","5214342","2352946","313079","8658909","2521778","4102630","1279010","8109409","1489841","3923832","797528","6438041","6988457","4094985","3110761","6446888","7452048","8121449","2276371","8365204","8441653","9640664","5675979","6551735","7420243","1809671","4347381","9975683","1211827","3854324","5732976","3786132","5988939","1354478","3264952","7387615","4988165","6492101","6535179","2849254","6655341","2957363","8148099","3744213","1278702","7301434","7486039","2634819","3457381","5004118","7293870","1668564","6629962","3446086","1554389","5056035","6555241","5560996","7582988","5300852","5406808","2212437","1577088","4879156","4460201","8982131","1673417","4838782","1027168","8009618","3407635","7334186","4748464","9851709","3308815","9990049","4628156","4660602","3099831","99508","3500193","724571","2555778","8503759","6933507","146012","7046560","3160683","3456569","4342059","3997281","3369713","5321871","8834861","4159934","9253491","602470","2378842","3372509","6532457","1913450","6161817","100699","9587606","8121704","3308072","2435176","4478755","1494490","4339383","7272720","3285546","6924510","1346466","4827561","3204908","1802824","873412","8739756","8545720","2467517","5938115","6911113","97271","4705936"],["26","42","08","26","04","39","38","28","15","52","29","28","29","43","52","02","58","41","32","30","16","48","54","44","46","37","46","36","44","07","24","05","51","39","19","37","12","56","45","58","54","31","13","19","27","36","46","29","08","31","01","45","53","35","11","07","53","36","53","05","34","43","57","27","44","34","40","17","23","26","08","36","04","51","54","51","16","12","56","12","37","02","36","27","42","09","58","19","19","58","32","19","09","22","48","30","29","54","07","25","23","04","07","39","09","44","09","50","58","12","05","52","01","23","03","36","36","49","14","53","30","40","52","10","28","59","58","30","41","54","18","06","52","16","32","25","59","16","51","28","06","08","45","58","53","26","03","44","14","02","32","26","40","46","32","46","05","45","03","08","03","38","20","22","45","05","37","16","46","05","10","24","53","20","04","45","60","19","20","24","18","07","01","52","38","43","23","21","03","28","03","50","39","03","44","46","40","30","58","09"],["N","S","N","N","S","S","N","S","N","S","N","N","N","N","N","S","N","N","N","N","N","S","S","N","N","N","S","S","N","S","S","S","S","N","N","N","N","S","S","N","N","S","S","N","N","N","S","N","N","S","S","N","S","N","N","N","N","S","N","N","N","S","S","N","S","N","N","S","S","N","N","S","N","S","S","N","N","N","N","S","S","N","N","N","S","N","S","N","S","N","S","S","S","N","S","S","S","S","N","N","S","N","S","N","N","S","S","N","S","N","S","S","N","N","S","N","N","S","S","N","N","N","N","S","S","S","S","S","N","N","N","S","S","S","N","S","S","S","S","N","S","S","N","N","S","N","N","S","S","N","S","N","S","S","N","N","N","N","S","S","N","S","N","S","N","S","S","N","S","S","S","N","S","S","N","S","N","N","S","N","N","S","S","S","N","S","N","S","N","S","S","N","N","N","N","N","N","N","N","S"],["26ULG6795051305","42GVA3872049796","08QMH2497278045","26UMG6771841649","04EDC0858351756","39JTK2182636172","38NPG0012351445","28LER5612454861","15TXM2565296484","52FDD2471718866","29XMF7425281597","28RDT4740909214","29PJP8452760322","43TGG3830160452","52PDA9459730032","02KLC6101569150","58NAH7069530212","41UQT0059843912","32PLP5342685640","30RVN8481117344","16WET7042841618","48KXU2451293956","54JWS1308095183","44NKG0953633881","46QFC4864981603","37WFS1970553933","46FGL0430116472","36CVE6301377269","44QLD1523511756","07GCR3820212773","24FVJ5465519949","05GKP5145748090","51KWU0000082575","39TUJ4727821408","19QED7266941123","37TFF8055152086","12NTM7421270262","56FPG3989583578","45LTE3620573052","58UED3909451293","54VVL2337029679","31KFV1315087357","13CDN9176851205","19QEC2301609283","27WVQ5393540691","36UUC9321976645","46KBG8660965843","29WPN3205372754","08XMP4814722445","31KGR8222584596","01MBR8688833292","45TWK7104573347","53DMG5825918469","35SMU0396352476","11UMP7185256384","07SFB9584931553","53PLP4428821427","36EUQ9007583565","53VMH9355185071","05TNE5284639041","34XDH8145963455","43EFM3953580942","57LUK5176561745","27QXV2423830824","44JMM3298500111","34RDV2960667520","40QFE7750512406","17DNF3599653887","23EML9646802153","26PJQ8985587192","08ULD2523529789","36CVC2353390834","04PFA2110217041","51FXA9269012477","54FWH0758762312","51TWN5845214342","16QCJ2673552946","12NYJ6681513079","56XMM6170958909","12DWL1028421778","37FCB7111302630","02PMT8364679010","36XVG0669409409","27PUQ0298589841","42FVE4861023832","09NYH3852197528","58HGK7726938041","19VFK0682688457","19FFA2334394985","58RES7955410761","32HQK7845546888","19KEQ1127052048","09KYB2466121449","22QGH4810676371","48LUJ0303265204","30LZK0021541653","29MPS5666340664","54HVB0396375979","07VEF6473151735","25WDQ9255720243","23CNU4733009671","04SCJ9993547381","07MDV6995675683","39PUN6669511827","09SVU5062254324","44HNC5402632976","09EXT6944186132","50UPE3885588939","58CDU6133254478","12RXT8805864952","05KMP1839287615","52GDQ9607788165","01VCE7022992101","23VPF1797035179","03DVJ6154449254","36VUM8796655341","36RXQ4520857363","49KDB9147348099","14EPC2518744213","53PQN2356178702","30WVU4791701434","40WDV8675686039","52QGM8122934819","10EDV4889857381","28GDR0481604118","59JPN6520993870","58CEB0805268564","30JVM2223929962","41RPQ4299746086","54PWA3670854389","18TXR0441156035","06JUL7415155241","52GCA6189660996","16KHA0909982988","32TMU6409700852","25GEQ2337306808","59DNC4803312437","16CDA9809577088","51GUJ3032779156","28TDK3795260201","06LTQ3298182131","08CNB5048673417","45TUJ6621938782","58PFR4058727168","53KMA1213209618","26RMV3494707635","03WVP2863234186","44GPN5015648464","14MRD1383851709","02RMU9227708815","32MLE3306990049","26TNM9138528156","40FEM9957060602","46EDR0017299831","32NLF4199399508","46RFA2613300193","05NQH5102124571","45QVF5084855778","03LYF9118403759","08JLQ1464233507","03NTB5074646012","38JMR2340146560","20RKS5541160683","22EEV1722156569","45SXD1653842059","05FLV4783297281","37EDP8373269713","16UCU3971721871","46LEP3829434861","05FMB7703059934","10MGT0668753491","24NVM0805302470","53DPD1114478842","20ELU8768272509","04VDL6085432457","45CWV8155713450","60UWG4725761817","19NHB0608600699","20MPA4769887606","24XWG1065221704","18RTU6048508072","07DEE6301735176","01FCE3168278755","52CEV0877694490","38SMJ1969639383","43JGN4698172720","23RMN9226185546","21JUK9656824510","03PWP2175746466","28GGP1799827561","03EWN0428704908","50QKD1893802824","39NXJ2456373412","03XWH5130239756","44XNL1357045720","46QFK0814967517","40UEE4434838115","30VWQ9276211113","58NDF3769297271","09GUH8690605936"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>longv<\/th>\n      <th>latv<\/th>\n      <th>UTME<\/th>\n      <th>UTMN<\/th>\n      <th>gz<\/th>\n      <th>hem<\/th>\n      <th>mgrs<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><!--/html_preserve-->

## Backwards without CRS


```r
MGRS <- "38MNA7993062259"

gl <- gsub("[^a-zA-Z]", "", MGRS)
gll <- str_locate(MGRS, gl)
zone <- as.numeric(substr(MGRS, 1, gll[1]-1))
gzn <- substr(MGRS, gll[1],gll[1])
gse <- substr(MGRS, gll[1]+1,gll[1]+1)
gsn <- substr(MGRS, gll[1]+2,gll[1]+2)

Easting <- 393477
Northing <- 6869162
hem <- "N"

NfEQ <- Northing
if (hem == "S"){NfEQ <- Northing - 10000000}
Fi <- (NfEQ)/(6366197.724*k0)
Ni <- (c/(1+e1sq*(cos(Fi))^2)^(1/2))*k0
Czone <- 6*zone-183
dln <- (Easting-500000)/Ni
A1 <- sin(2*Fi)
A2 <- A1*(cos(Fi))^2
J2 <- Fi+(A1/2)
J4 <- (3*J2+A2)/4
J6 <- (5*J4+A2*(cos(Fi))^2)/3
alfa <- 3/4*e1sq
beta <- 5/3*alfa^2
gamma <- 35/27*alfa^3
Bfi <- k0*c*(Fi-(alfa*J2)+(beta*J4)-(gamma*J6))
BB <- (NfEQ-Bfi)/Ni
zeta <- ((e1sq*dln^2)/2)*(cos(Fi))^2
Xi <- dln*(1-(zeta/3))
Eta <- BB*(1-zeta)+Fi
ShXi <- (exp(Xi)-exp(-Xi))/2
dLam <- atan(ShXi/cos(Eta))
Tau <- atan(cos(dLam)*tan(Eta))
FiR <- Fi+(1+e1sq*(cos(Fi))^2-(3/2)*e1sq*sin(Fi)*cos(Fi)*(Tau-Fi))*(Tau-Fi)
LAT <- FiR/pi*180
LNG <- dLam/pi*180+Czone 

paste(LAT, LNG)
```

```
## [1] "61.9400034685543 42.96999039276"
```


## Conclusion
