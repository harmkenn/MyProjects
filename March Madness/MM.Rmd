---
title: "Predicting March Madness"
author: "Ken Harmon"
date: "`r format(Sys.time(), '%Y %B %d')`"
output:
  html_document:  
    keep_md: true
    code_folding: hide
    fig_height: 6
    fig_width: 12
    fig_align: 'center'
editor_options: 
  chunk_output_type: console
---

# {.tabset .tabset-fade}

```{r, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(ggplot2)
library(tidyverse)
library(mosaic)
library(PerformanceAnalytics)
library(stringr)
library(psych) 
```

## Background

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
all_Games <- as_tibble(read.csv("All_NCAA_Tournament_Games.csv"))
SeasonStats <- as_tibble(read.csv("NCAASeasonTeamStats.csv"))

```

```{r Cds}
Games2000_19 <- all_Games %>% filter(Year > 1999) %>% tibble::rowid_to_column("ID")
wss <- SeasonStats %>% mutate(Year = as.integer(str_extract(Season, "^.{4}")) + 1) %>% setNames(paste0("w_",names(.)))
lss <- SeasonStats %>% mutate(Year = as.integer(str_extract(Season, "^.{4}")) + 1) %>% setNames(paste0("l_",names(.)))
JoinedWinnerStats <- left_join(Games2000_19,wss,by = c("Year" = "w_Year","Winner" = "w_Team"))
JoinedLoserStats <- left_join(JoinedWinnerStats,lss,by = c("Year" = "l_Year","Loser" = "l_Team"))
ws <- JoinedLoserStats %>% select(starts_with("w_")) %>% select(3:33)
ls <- JoinedLoserStats %>% select(contains("l_")) %>% select(3:33)
dwl <- ws - ls
dwl <- dwl %>% rename_all(funs(str_replace(., "w_", "d_"))) %>% tibble::rowid_to_column("ID")
GWSLSDS2000_19 <- left_join(JoinedLoserStats,dwl,by = c("ID" = "ID"))
```

```{r correlation}
bestfit <- GWSLSDS2000_19 %>% select(MV,starts_with("d_"))%>%select(1,6:7)
chart.Correlation(bestfit,histogram=TRUE, pch=19)
```

```{r lm}
mmlm <- lm(MV~d_SRS +d_SOS, bestfit)
summary(mmlm)
```

